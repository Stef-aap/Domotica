<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><title>
		</title>
		<style type="text/css">
			.cs95E872D0{text-align:left;text-indent:0pt;margin:0pt 0pt 0pt 0pt}
			.cs84FBA952{color:#000000;background-color:transparent;font-family:Calibri;font-size:17pt;font-weight:normal;font-style:normal;}
			.csB33285EC{color:#808080;background-color:transparent;font-family:Calibri;font-size:10pt;font-weight:normal;font-style:normal;}
			.cs14438CD8{text-align:left;text-indent:0pt;margin:0pt 0pt 0pt 0pt}
			.cs1B16EEB5{color:#000000;background-color:transparent;font-family:Calibri;font-size:11pt;font-weight:normal;font-style:normal;}
			.csA27DA275{color:#000000;background-color:transparent;font-family:Calibri;font-size:16pt;font-weight:bold;font-style:normal;}
			.cs9C490B4D{text-align:left;margin:0pt 0pt 0pt 18pt;list-style-type:disc;color:#000000;background-color:transparent;font-family:Arial;font-size:11pt;font-weight:normal;font-style:normal}
			.csD5D7D290{color:#000000;background-color:transparent;font-family:Arial;font-size:11pt;font-weight:normal;font-style:normal;}
			.cs2F445579{text-align:left;text-indent:0pt;margin:0pt 0pt 0pt 27pt}
			.cs2D2816FE{}
			.cs4974C6A2{width:385.2pt;padding:1.95pt 3pt 1.95pt 3pt;border-top:1pt #A3A3A3 solid;border-right:1pt #A3A3A3 solid;border-bottom:1pt #A3A3A3 solid;border-left:1pt #A3A3A3 solid}
			.csD7F14B45{width:191.8pt;padding:1.95pt 3pt 1.95pt 3pt;border-top:1pt #A3A3A3 solid;border-right:1pt #A3A3A3 solid;border-bottom:1pt #A3A3A3 solid;border-left:1pt #A3A3A3 solid}
			.csDED119D5{width:406.45pt;padding:1.95pt 3pt 1.95pt 3pt;border-top:1pt #A3A3A3 solid;border-right:1pt #A3A3A3 solid;border-bottom:1pt #A3A3A3 solid;border-left:1pt #A3A3A3 solid}
			.cs10095E8{width:271.05pt;padding:1.95pt 3pt 1.95pt 3pt;border-top:1pt #A3A3A3 solid;border-right:1pt #A3A3A3 solid;border-bottom:1pt #A3A3A3 solid;border-left:1pt #A3A3A3 solid}
			.csCF6BBF71{color:#000000;background-color:transparent;font-family:Times New Roman;font-size:12pt;font-weight:normal;font-style:normal;}
			.cs7FC7682D{color:#969696;background-color:transparent;font-family:Arial;font-size:9pt;font-weight:normal;font-style:normal;}
		</style>
	</head>
	<body>
		<p class="cs95E872D0"><span class="cs84FBA952">DIY RFLink, Optimalisatie 2</span></p><p class="cs95E872D0"><span class="csB33285EC">3 August, 2018</span></p><p class="cs95E872D0"><span class="csB33285EC">15:34</span></p><p class="cs14438CD8"><span class="cs1B16EEB5">&nbsp;</span></p><p class="cs14438CD8"><span class="csA27DA275">Samenvatting:</span></p><p class="cs14438CD8"><span class="cs1B16EEB5">Op dit punt is besloten zelf verder te gaan op basis van R29 sources.</span></p><p class="cs14438CD8"><span class="cs1B16EEB5">Echt meten en optimaal instellen van LoopsPerMillis, meten is gelukt, optimale instelling nog niet gevonden.</span></p><p class="cs14438CD8"><span class="cs1B16EEB5">&nbsp;</span></p><p class="cs14438CD8"><span class="cs1B16EEB5">&nbsp;</span></p><p class="cs14438CD8"><span class="csA27DA275">Geconstateerde problemen</span></p><p class="cs14438CD8"><span class="cs1B16EEB5">QIA remote D wordt anders gedetecteerd dan A,B,C</span></p><p class="cs14438CD8"><span class="cs1B16EEB5">6-knops links en rechts worden verschillend gedetecteerd</span></p><p class="cs14438CD8"><span class="cs1B16EEB5">Ventilatie wordt op diverse manieren gedetecteerd.</span></p><p class="cs14438CD8"><span class="cs1B16EEB5">Deurbel zou een random code moeten bevatten, maar daar is niet veel van terug te vinden</span></p><p class="cs14438CD8"><span class="cs1B16EEB5">Bed besturing doet het niet</span></p><p class="cs14438CD8"><span class="cs1B16EEB5">Beperkt aantal valse meldingen (ongeveer 1 per uur)</span></p><p class="cs14438CD8"><span class="cs1B16EEB5">&nbsp;</span></p><p class="cs14438CD8"><span class="cs1B16EEB5">Er zijn een paar knoppen die bij ingedrukt houden geen consistente detectie geven</span></p><ul style="margin-top:0;margin-bottom:0;">
			<li class="cs9C490B4D"><span class="cs1B16EEB5">Ventilatie +</span></li><li class="cs9C490B4D"><span class="cs1B16EEB5">Ventilatie -</span></li><li class="cs9C490B4D"><span class="cs1B16EEB5">6 button 3R</span></li></ul>
		<p class="cs14438CD8"><span class="cs1B16EEB5">&nbsp;</span></p><p class="cs14438CD8"><span class="cs1B16EEB5">&nbsp;</span></p><p class="cs14438CD8"><span class="csA27DA275">LoopsPerMilli</span></p><p class="cs14438CD8"><span class="cs1B16EEB5">&nbsp;</span></p><p class="cs14438CD8"><span class="csD5D7D290"><img src="DIY%20RFLink%20Optimalisatie%202_files/image0.png" width="874" height="294" alt="" style="border-width:0px;" /></span></p><p class="cs14438CD8"><span class="cs1B16EEB5">&nbsp;</span></p><p class="cs14438CD8"><span class="cs1B16EEB5">De Timeout value staat ingesteld op 7 msec, we hebben dus iets meer dan een waarde van 4000 nodig.</span></p><p class="cs14438CD8"><span class="cs1B16EEB5">Dit zou overigens ook betekenen dat de ESP32 meer dan 20 keer sneller is dann een Arduino Mega.</span></p><p class="cs14438CD8"><span class="cs1B16EEB5">Voor dit moment hebben we echter een beter gevoel bij een waarde van 1500. Als we naar de QIAchip series kijken, zien we dat met name de begin puls (pre-ample) beter wordt gedetecteerd (dede is in het echt namelijk 2.5 msec.</span></p><p class="cs14438CD8"><span class="cs1B16EEB5">In een later stadium zullen we kijken of we deze parameter beter kunnen tunen,</span></p><p class="cs14438CD8"><span class="cs1B16EEB5">&nbsp;</span></p><p class="cs14438CD8"><span class="cs1B16EEB5">&nbsp;</span></p><p class="cs14438CD8"><span class="csA27DA275">Betere logging/displaying</span><span class="cs1B16EEB5"> </span></p><p class="cs14438CD8"><span class="cs1B16EEB5">van meetresultaten en interpretaties.</span></p><p class="cs14438CD8"><span class="cs1B16EEB5">De gebruikte Debug parameters vinden wij onvoldoende:</span></p><p class="cs2F445579"><span class="cs1B16EEB5">&nbsp;</span></p><p class="cs2F445579"><span class="csD5D7D290"><img src="DIY%20RFLink%20Optimalisatie%202_files/image1.png" width="309" height="74" alt="" style="border-width:0px;" /></span></p><p class="cs14438CD8"><span class="cs1B16EEB5">Daarom hebben we deze vervangen door&nbsp; &quot;LEARNING_MODE&quot; , een parameter die gemakkelijk is uit te breiden.</span></p><p class="cs14438CD8"><span class="cs1B16EEB5">&nbsp;</span></p><p class="cs2F445579"><span class="csD5D7D290"><img src="DIY%20RFLink%20Optimalisatie%202_files/image2.png" width="560" height="97" alt="" style="border-width:0px;" /></span></p><p class="cs14438CD8"><span class="cs1B16EEB5">&nbsp;</span></p><p class="cs14438CD8"><span class="cs1B16EEB5">&nbsp;</span></p><p class="cs14438CD8"><span class="csA27DA275">Production Mode</span></p><p class="cs14438CD8"><span class="cs1B16EEB5">Omdat we zo weinig mogelijk vals positieve detecties willen hebben, is het goed om alleen de protocollen actief te hebben die ook daadwerkelijk gebruikt gaan worden. Heb je een nieuw device, schakel dan tijdelijk naar de Learning mode, laat het programma de juiste detectie doen en ga weer naar productie mode.</span></p><p class="cs14438CD8"><span class="cs1B16EEB5">&nbsp;</span></p><p class="cs14438CD8"><span class="cs1B16EEB5">&nbsp;</span></p><p class="cs14438CD8"><span class="csA27DA275">Volgorde Protocollen</span></p><p class="cs14438CD8"><span class="cs1B16EEB5">Naast beperken van het aantal aktieve protocollen is het goed om eenvoudig de volgorde te bepalen waarin de protocollen worden getoetst. Dit hebben we voorlopig even opgelost door de define van een protocol een integer waarde mee te geven. Deze integer waarde beapplt simpelweg de absolute positie in de lijst met actieve protocollen. </span></p><p class="cs14438CD8"><span class="cs1B16EEB5">&nbsp;</span></p><p class="cs2F445579"><span class="csD5D7D290"><img src="DIY%20RFLink%20Optimalisatie%202_files/image3.png" width="740" height="214" alt="" style="border-width:0px;" /></span></p><p class="cs14438CD8"><span class="cs1B16EEB5">&nbsp;</span></p><p class="cs14438CD8"><span class="cs1B16EEB5">Tijdens het testen willen we graag zien welke protocollen actief zijn en in welke volgorde ze worden aangeroepen. Daarom printen we alle protocollen als we niet in de productie mode zitten:</span></p><p class="cs14438CD8"><span class="cs1B16EEB5">&nbsp;</span></p><table class="cs2D2816FE" border="0" cellspacing="0" cellpadding="0" style="border-collapse:collapse;">
			<tr>
				<td class="cs4974C6A2" valign="top" width="514"><p class="cs95E872D0"><span class="cs1B16EEB5">Tijdens het testen willen we graag zien welke protocollen actief zijn en in welke volgorde ze worden aangeroepen. Daarom printen we alle protcollen als we niet in de productie mode zitten:</span></p></td><td class="csD7F14B45" valign="top" width="256"><p class="cs95E872D0"><span class="cs1B16EEB5">20;00;Nodo RadioFrequencyLink V1.1;</span></p><p class="cs95E872D0"><span class="cs1B16EEB5">&nbsp;</span></p><p class="cs95E872D0"><span class="cs1B16EEB5">Protocol Available = 1</span></p><p class="cs95E872D0"><span class="cs1B16EEB5">Protocol Available = 5</span></p><p class="cs95E872D0"><span class="cs1B16EEB5">Protocol Available = 2</span></p><p class="cs95E872D0"><span class="cs1B16EEB5">Protocol Available = 3</span></p><p class="cs95E872D0"><span class="cs1B16EEB5">Protocol Available = 4</span></p><p class="cs95E872D0"><span class="cs1B16EEB5">Protocol Available = 6</span></p><p class="cs95E872D0"><span class="cs1B16EEB5">Protocol Available = 7</span></p><p class="cs95E872D0"><span class="cs1B16EEB5">Protocol Available = 8</span></p><p class="cs95E872D0"><span class="cs1B16EEB5">Protocol Available = 9</span></p><p class="cs95E872D0"><span class="cs1B16EEB5">Protocol Available = 11</span></p><p class="cs95E872D0"><span class="cs1B16EEB5">Protocol Available = 12</span></p><p class="cs95E872D0"><span class="cs1B16EEB5">Protocol Available = 13</span></p><p class="cs95E872D0"><span class="cs1B16EEB5">Protocol Available = 15</span></p><p class="cs95E872D0"><span class="cs1B16EEB5">Protocol Available = 60</span></p><p class="cs95E872D0"><span class="cs1B16EEB5">Protocol Available = 61</span></p><p class="cs95E872D0"><span class="cs1B16EEB5">Protocol Available = 62</span></p><p class="cs95E872D0"><span class="cs1B16EEB5">Protocol Available = 254</span></p></td></tr>
		</table>
		<p class="cs14438CD8"><span class="cs1B16EEB5">&nbsp;</span></p><p class="cs14438CD8"><span class="cs1B16EEB5">&nbsp;</span></p><p class="cs14438CD8"><span class="csA27DA275">Learning Mode 2</span></p><p class="cs14438CD8"><span class="cs1B16EEB5">&nbsp;</span></p><p class="cs14438CD8"><span class="csD5D7D290"><img src="DIY%20RFLink%20Optimalisatie%202_files/image4.png" width="542" height="125" alt="" style="border-width:0px;" /></span></p><p class="cs14438CD8"><span class="cs1B16EEB5">&nbsp;</span></p><table class="cs2D2816FE" border="0" cellspacing="0" cellpadding="0" style="border-collapse:collapse;">
			<tr>
				<td class="csDED119D5" valign="top" width="542"><p class="cs95E872D0"><span class="cs1B16EEB5">And here you can see the Learning Mode 2 in action.</span></p><p class="cs95E872D0"><span class="cs1B16EEB5">Notenhouten ABCD switch, dit is een QIAchip.</span></p><p class="cs95E872D0"><span class="cs1B16EEB5">&nbsp;</span></p><p class="cs95E872D0"><span class="cs1B16EEB5">The A-button of this chip is recognized by both protocol 5 and protocol 61. Interesting to see that the decoding is different. Also interesting is that the code signal is inverted and the only way we can explain it at this moment is that there&#39;s a bug in the program.</span></p></td><td class="cs10095E8" valign="top" width="362"><p class="cs95E872D0"><span class="cs1B16EEB5">20;01;Eurodomest;ID=0ffa20;SWITCH=07;CMD=ALLOFF;</span></p><p class="cs95E872D0"><span class="cs1B16EEB5">LM=2&nbsp;&nbsp;&nbsp; ID=5&nbsp;&nbsp;&nbsp; Len=50</span></p><p class="cs95E872D0"><span class="cs1B16EEB5">20;02;X10;ID=a20e;SWITCH=ff;CMD=ON;</span></p><p class="cs95E872D0"><span class="cs1B16EEB5">LM=2&nbsp;&nbsp;&nbsp; ID=61&nbsp;&nbsp;&nbsp; Len=50</span></p><p class="cs95E872D0"><span class="cs1B16EEB5">&nbsp;</span></p><p class="cs95E872D0"><span class="cs1B16EEB5">20;03;Eurodomest;ID=0ffa20;SWITCH=07;CMD=ALLOFF;</span></p><p class="cs95E872D0"><span class="cs1B16EEB5">LM=2&nbsp;&nbsp;&nbsp; ID=5&nbsp;&nbsp;&nbsp; Len=50</span></p><p class="cs95E872D0"><span class="cs1B16EEB5">20;04;X10;ID=a20e;SWITCH=ff;CMD=ON;</span></p><p class="cs95E872D0"><span class="cs1B16EEB5">LM=2&nbsp;&nbsp;&nbsp; ID=61&nbsp;&nbsp;&nbsp; Len=50</span></p></td></tr>
			<tr>
				<td class="csDED119D5" valign="top" width="542"><p class="cs95E872D0"><span class="cs1B16EEB5">Pressing the D-button, shows some other interesting things:</span></p><p class="cs95E872D0"><span class="cs1B16EEB5">Protocol 5 doesn&#39;t recognize the signal anymore</span></p></td><td class="cs10095E8" valign="top" width="362"><p class="cs95E872D0"><span class="cs1B16EEB5">20;05;X10;ID=a207;SWITCH=ff;CMD=ON;</span></p><p class="cs95E872D0"><span class="cs1B16EEB5">LM=2&nbsp;&nbsp;&nbsp; ID=61&nbsp;&nbsp;&nbsp; Len=50</span></p><p class="cs95E872D0"><span class="cs1B16EEB5">&nbsp;</span></p><p class="cs95E872D0"><span class="cs1B16EEB5">LM=2&nbsp;&nbsp;&nbsp; ID=61&nbsp;&nbsp;&nbsp; Len=50</span></p><p class="cs95E872D0"><span class="cs1B16EEB5">&nbsp;</span></p><p class="cs95E872D0"><span class="cs1B16EEB5">LM=2&nbsp;&nbsp;&nbsp; ID=61&nbsp;&nbsp;&nbsp; Len=50</span></p><p class="cs95E872D0"><span class="cs1B16EEB5">&nbsp;</span></p><p class="cs95E872D0"><span class="cs1B16EEB5">LM=2&nbsp;&nbsp;&nbsp; ID=61&nbsp;&nbsp;&nbsp; Len=50</span></p><p class="cs95E872D0"><span class="cs1B16EEB5">&nbsp;</span></p><p class="cs95E872D0"><span class="cs1B16EEB5">LM=2&nbsp;&nbsp;&nbsp; ID=61&nbsp;&nbsp;&nbsp; Len=50</span></p><p class="cs95E872D0"><span class="cs1B16EEB5">&nbsp;</span></p><p class="cs95E872D0"><span class="cs1B16EEB5">LM=2&nbsp;&nbsp;&nbsp; ID=61&nbsp;&nbsp;&nbsp; Len=50</span></p></td></tr>
		</table>
		<p class="cs14438CD8"><span class="cs1B16EEB5">&nbsp;</span></p><p class="cs14438CD8"><span class="cs1B16EEB5">&nbsp;</span></p><p class="cs14438CD8"><span class="csA27DA275">QIAchip</span></p><p class="cs14438CD8"><span class="cs1B16EEB5">The QIAchip uses an EV1527 Encoding, so we would expect something like this</span></p><p class="cs14438CD8"><span class="cs1B16EEB5">&hellip;.</span></p><p class="cs14438CD8"><span class="cs1B16EEB5">Based on the above description, the decoding criteria should be:</span></p><p class="cs14438CD8"><span class="cs1B16EEB5">&hellip;.</span></p><p class="cs14438CD8"><span class="cs1B16EEB5">Looking at the protocols 5 and 61 which is, pure technical seen, the best decoding algoritm ?</span></p><p class="cs14438CD8"><span class="cs1B16EEB5">,,,,</span></p><p class="cs14438CD8"><span class="cs1B16EEB5">And now what e the correct interpretation of this signal and how should we send it to e.g. Domoticz ?</span></p><p class="cs14438CD8"><span class="cs1B16EEB5">&hellip;.</span></p><p class="cs14438CD8"><span class="cs1B16EEB5">&nbsp;</span></p><p class="cs14438CD8"><span class="cs1B16EEB5">&nbsp;</span></p><p class="cs14438CD8"><span class="csA27DA275">Knop-A</span></p><p class="cs14438CD8"><span class="cs1B16EEB5">Geeft onderstaande code terug (protocol 254 is gewijzgd, zodat ook het eerste element wordt weergegeven).</span></p><p class="cs14438CD8"><span class="cs1B16EEB5">&nbsp;</span></p><p class="cs14438CD8"><span class="cs1B16EEB5">2400,270,690,270,690,270,690,270,690,270,690,270,690,270,690,270,690,270,690,750,210,270,690,750,210,750,210,750,210,270,690,750,210,750,210,750,210,750,210,750,210,240,720,270,690,240,690,750,210,240,2640;</span></p><p class="cs14438CD8"><span class="cs1B16EEB5">&nbsp;</span></p><p class="cs14438CD8"><span class="cs1B16EEB5">&nbsp;</span></p><p class="cs14438CD8"><span class="cs1B16EEB5">&nbsp;</span></p><p class="cs14438CD8"><span class="cs1B16EEB5">&nbsp;</span></p><p class="cs14438CD8"><span class="cs1B16EEB5">&nbsp;</span></p><p class="cs14438CD8"><span class="cs1B16EEB5">&nbsp;</span></p><p class="cs14438CD8"><span class="cs1B16EEB5">&nbsp;</span></p><p class="cs14438CD8"><span class="cs1B16EEB5">&nbsp;</span></p><p class="cs95E872D0"><span class="csCF6BBF71">&nbsp;</span></p><p class="cs95E872D0"><span class="cs7FC7682D">Created with Microsoft Office OneNote 2007<br/>One place for all your notes and information</span></p></body>
</html>
