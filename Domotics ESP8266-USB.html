<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><title>
		</title>
		<style type="text/css">
			.cs95E872D0{text-align:left;text-indent:0pt;margin:0pt 0pt 0pt 0pt}
			.cs84FBA952{color:#000000;background-color:transparent;font-family:Calibri;font-size:17pt;font-weight:normal;font-style:normal;}
			.csB33285EC{color:#808080;background-color:transparent;font-family:Calibri;font-size:10pt;font-weight:normal;font-style:normal;}
			.cs14438CD8{text-align:left;text-indent:0pt;margin:0pt 0pt 0pt 0pt}
			.cs1B16EEB5{color:#000000;background-color:transparent;font-family:Calibri;font-size:11pt;font-weight:normal;font-style:normal;}
			.csA27DA275{color:#000000;background-color:transparent;font-family:Calibri;font-size:16pt;font-weight:bold;font-style:normal;}
			.csDC4A80{color:#000000;background-color:transparent;font-family:Calibri;font-size:11pt;font-weight:bold;font-style:normal;}
			.csB4F56505{color:#000000;background-color:transparent;font-family:Calibri;font-size:11pt;font-weight:normal;font-style:normal;text-decoration: none;}
			.cs777ED152{color:#0000FF;background-color:transparent;font-family:Calibri;font-size:11pt;font-weight:normal;font-style:normal;text-decoration: underline;}
			.csD5D7D290{color:#000000;background-color:transparent;font-family:Arial;font-size:11pt;font-weight:normal;font-style:normal;}
			.cs9C490B4D{text-align:left;margin:0pt 0pt 0pt 18pt;list-style-type:disc;color:#000000;background-color:transparent;font-family:Arial;font-size:11pt;font-weight:normal;font-style:normal}
			.cs47C2B048{color:#000000;background-color:transparent;font-family:Courier New;font-size:8.5pt;font-weight:normal;font-style:normal;}
			.csBCF377F1{color:#067676;background-color:transparent;font-family:Courier New;font-size:8.5pt;font-weight:normal;font-style:normal;}
			.cs5FC355D3{color:#666666;background-color:transparent;font-family:Tahoma;font-size:8pt;font-weight:normal;font-style:normal;}
			.cs7B98B7A9{color:#666666;background-color:transparent;font-family:Tahoma;font-size:8pt;font-weight:normal;font-style:normal;text-decoration: none;}
			.cs77704D4E{color:#0000FF;background-color:transparent;font-family:Tahoma;font-size:8pt;font-weight:normal;font-style:normal;text-decoration: underline;}
			.csCF6BBF71{color:#000000;background-color:transparent;font-family:Times New Roman;font-size:12pt;font-weight:normal;font-style:normal;}
			.cs7FC7682D{color:#969696;background-color:transparent;font-family:Arial;font-size:9pt;font-weight:normal;font-style:normal;}
		</style>
	</head>
	<body>
		<p class="cs95E872D0"><span class="cs84FBA952">Domoticz, ESP8266-USB</span></p><p class="cs95E872D0"><span class="csB33285EC">29 July, 2018</span></p><p class="cs95E872D0"><span class="csB33285EC">8:57</span></p><p class="cs14438CD8"><span class="cs1B16EEB5">&nbsp;</span></p><p class="cs14438CD8"><span class="csA27DA275">Inleiding</span></p><p class="cs14438CD8"><span class="cs1B16EEB5">Als de Esp via de USB verbonden is met de Domoticz server, dan kun je hem uiteraard niet gelijktijdig (her-)programmeren.</span></p><p class="cs14438CD8"><span class="cs1B16EEB5">&nbsp;&nbsp;&nbsp; Dus in Domoticz, setup / hardware / select ESP / Disable / Update om ESP te kunnen programmeren.</span></p><p class="cs14438CD8"><span class="cs1B16EEB5">&nbsp;&nbsp;&nbsp; Na het programmeren laat Arduino de poort los (mits je niet de serial Monitor hebt openstaan)&nbsp; en kan dus weer in Domoticz ge-enabeld worden.</span></p><p class="cs14438CD8"><span class="cs1B16EEB5">Als eerste voorbeeld gebruikt: </span></p><p class="cs14438CD8"><span class="cs1B16EEB5">&nbsp;&nbsp;&nbsp; </span><span class="csDC4A80">MySensors / GatewaySerial</span></p><p class="cs14438CD8"><span class="cs1B16EEB5">Je moet alles na</span></p><p class="cs14438CD8"><span class="cs1B16EEB5">&nbsp;&nbsp;&nbsp; #include &lt;MySensors.h&gt;</span></p><p class="cs14438CD8"><span class="cs1B16EEB5">Vervangen door functionele code</span></p><p class="cs14438CD8"><span class="cs1B16EEB5">Voor een eenvoudige pin detectie als schakelaar heb ik daarvoor de volgende code gebruikt</span></p><p class="cs14438CD8"><span class="cs1B16EEB5">&nbsp;&nbsp;&nbsp; <a class="csB4F56505" href="https://diyprojects.io/mysensors-2-0-esp8266-wifi-gateway-domoticz/"><span class="cs777ED152">https://diyprojects.io/mysensors-2-0-esp8266-wifi-gateway-domoticz/</span></a></span></p><p class="cs14438CD8"><span class="cs1B16EEB5">&nbsp;</span></p><p class="cs14438CD8"><span class="cs1B16EEB5">Pas op er zit 1 grote bug in dit programma of het duurt tering lang, waardoor je het geheel niet aan de praat krijgt</span></p><p class="cs14438CD8"><span class="cs1B16EEB5">&nbsp;</span></p><p class="cs14438CD8"><span class="cs1B16EEB5">In principe kopieer je de functionele code (in dit geval alles) in het example programma GatewaySerial (na #include MySensors).</span></p><p class="cs14438CD8"><span class="cs1B16EEB5">Als je de ESP8266 programmeert en in Domoticz de hardware toevoegt: invullen en op add drukken</span></p><p class="cs14438CD8"><span class="cs1B16EEB5">&nbsp;</span></p><p class="cs14438CD8"><span class="csD5D7D290"><img src="Domotics%20ESP8266-USB_files/image0.png" width="772" height="422" alt="" style="border-width:0px;" /></span></p><p class="cs14438CD8"><span class="cs1B16EEB5">&nbsp;</span></p><p class="cs14438CD8"><span class="cs1B16EEB5">Dan zie je het volgende:</span></p><p class="cs14438CD8"><span class="cs1B16EEB5">&nbsp;</span></p><p class="cs14438CD8"><span class="cs1B16EEB5">&nbsp;</span></p><p class="cs14438CD8"><span class="csD5D7D290"><img src="Domotics%20ESP8266-USB_files/image1.png" width="947" height="196" alt="" style="border-width:0px;" /></span></p><p class="cs14438CD8"><span class="cs1B16EEB5">&nbsp;</span></p><p class="cs14438CD8"><span class="cs1B16EEB5">Het lijkt erop dat de ESP gezien wordt door Domoticz, maar de Versie is een vraagteken. Druk je nu op Setup dan zie je ook geen enkel device</span></p><p class="cs14438CD8"><span class="cs1B16EEB5">&nbsp;</span></p><p class="cs14438CD8"><span class="cs1B16EEB5">&nbsp;</span></p><p class="cs14438CD8"><span class="csD5D7D290"><img src="Domotics%20ESP8266-USB_files/image2.png" width="946" height="620" alt="" style="border-width:0px;" /></span></p><p class="cs14438CD8"><span class="cs1B16EEB5">&nbsp;</span></p><p class="cs14438CD8"><span class="cs1B16EEB5">&nbsp;</span></p><p class="cs14438CD8"><span class="cs1B16EEB5">Zodra de hardware wordt toegevoegd (en de hardware is aanwezig), is dit te zien in de log file (Setup / Log)</span></p><p class="cs14438CD8"><span class="cs1B16EEB5">&nbsp;</span></p><p class="cs14438CD8"><span class="csD5D7D290"><img src="Domotics%20ESP8266-USB_files/image3.png" width="559" height="27" alt="" style="border-width:0px;" /></span></p><p class="cs14438CD8"><span class="cs1B16EEB5">&nbsp;</span></p><p class="cs14438CD8"><span class="cs1B16EEB5">Nu duurt het of heel lang</span></p><p class="cs14438CD8"><span class="cs1B16EEB5">&nbsp;&nbsp;&nbsp;&nbsp; of</span></p><p class="cs14438CD8"><span class="cs1B16EEB5">De bug speelt parten</span></p><p class="cs14438CD8"><span class="cs1B16EEB5">&nbsp;&nbsp;&nbsp; of</span></p><p class="cs14438CD8"><span class="cs1B16EEB5">Je moet op reset van de ESP8266 drukken</span></p><p class="cs14438CD8"><span class="cs1B16EEB5">&nbsp;</span></p><p class="cs14438CD8"><span class="cs1B16EEB5">En dan gebeuren er een aantal dingen:</span></p><ul style="margin-top:0;margin-bottom:0;">
			<li class="cs9C490B4D"><span class="cs1B16EEB5">Er verschijnt een versie nummer bij de hardware</span></li><li class="cs9C490B4D"><span class="cs1B16EEB5">Er verschijnen devices bij de hardware</span></li></ul>
		<p class="cs14438CD8"><span class="cs1B16EEB5">&nbsp;</span></p><p class="cs14438CD8"><span class="cs1B16EEB5">&nbsp;</span></p><p class="cs14438CD8"><span class="csD5D7D290"><img src="Domotics%20ESP8266-USB_files/image4.png" width="941" height="55" alt="" style="border-width:0px;" /></span></p><p class="cs14438CD8"><span class="cs1B16EEB5">&nbsp;</span></p><p class="cs14438CD8"><span class="cs1B16EEB5">&nbsp;</span></p><p class="cs14438CD8"><span class="cs1B16EEB5">&nbsp;</span></p><p class="cs14438CD8"><span class="cs1B16EEB5">&nbsp;</span></p><p class="cs14438CD8"><span class="csA27DA275">Serial Monitor</span></p><p class="cs14438CD8"><span class="cs1B16EEB5">Dit is wat er op de Serial Monitor is te zien:</span></p><p class="cs14438CD8"><span class="cs1B16EEB5">0;255;3;0;14;Gateway startup complete.</span></p><p class="cs14438CD8"><span class="cs1B16EEB5">0;255;0;0;17;2.3.0</span></p><p class="cs14438CD8"><span class="cs1B16EEB5">0;255;3;0;11;Reed switch Test</span></p><p class="cs14438CD8"><span class="cs1B16EEB5">0;255;3;0;12;1.0</span></p><p class="cs14438CD8"><span class="cs1B16EEB5">0;1;0;0;0;</span></p><p class="cs14438CD8"><span class="cs1B16EEB5">0;255;3;0;9;52 MCO:BGN:STP</span></p><p class="cs14438CD8"><span class="cs1B16EEB5">0;255;3;0;9;63 MCO:REG:NOT NEEDED</span></p><p class="cs14438CD8"><span class="cs1B16EEB5">0;255;3;0;9;67 MCO:BGN:INIT OK,TSP=NA</span></p><p class="cs14438CD8"><span class="cs1B16EEB5">Switch state Open </span></p><p class="cs14438CD8"><span class="cs1B16EEB5">0;1;1;0;16;1</span></p><p class="cs14438CD8"><span class="cs1B16EEB5">Switch state Close</span></p><p class="cs14438CD8"><span class="cs1B16EEB5">0;1;1;0;16;0</span></p><p class="cs14438CD8"><span class="cs1B16EEB5">Switch state Open </span></p><p class="cs14438CD8"><span class="cs1B16EEB5">0;1;1;0;16;1</span></p><p class="cs14438CD8"><span class="cs1B16EEB5">&nbsp;</span></p><p class="cs14438CD8"><span class="cs1B16EEB5">&nbsp;</span></p><p class="cs14438CD8"><span class="cs1B16EEB5">&nbsp;</span></p><p class="cs14438CD8"><span class="csD5D7D290"><img src="Domotics%20ESP8266-USB_files/image5.png" width="621" height="156" alt="" style="border-width:0px;" /></span></p><p class="cs14438CD8"><span class="cs1B16EEB5">&nbsp;</span></p><p class="cs14438CD8"><span class="cs1B16EEB5">&nbsp;</span></p><p class="cs14438CD8"><span class="csA27DA275">Log</span></p><p class="cs14438CD8"><span class="cs1B16EEB5">En als je hem aansluit in Domoticz en de connectie lukt, zie je in de log</span></p><p class="cs14438CD8"><span class="cs47C2B048">2018-07-29 08:55:21.556 (weather undergroudn) Rain (Rain)</span></p><p class="cs14438CD8"><span class="cs47C2B048">2018-07-29 08:55:21.590 (weather undergroudn) General/Visibility (Visibility)</span></p><p class="cs14438CD8"><span class="cs47C2B048">2018-07-29 08:55:21.628 (weather undergroudn) General/Solar Radiation (Solar Radiation)</span></p><p class="cs14438CD8"><span class="cs47C2B048">2018-07-29 08:58:37.273 MySensors: Gateway Ready...</span></p><p class="cs14438CD8"><span class="cs47C2B048">2018-07-29 08:58:37.449 MySensors: Gateway Version: 2.3.0</span></p><p class="cs14438CD8"><span class="cs47C2B048">2018-07-29 08:58:37.514 (mysensor USB) Light/Switch (Security Sensor)</span></p><p class="cs14438CD8"><span class="cs47C2B048">2018-07-29 08:58:37.564 (mysensor USB) Light/Switch (Security Sensor)</span></p><p class="cs14438CD8"><span class="csBCF377F1">2018-07-29 08:58:37.166 Status: MySensors: Using serial port: COM10</span></p><p class="cs14438CD8"><span class="csBCF377F1">2018-07-29 08:58:37.390 Status: MySensors: Node: 0, Sketch Name: Reed switch Test</span></p><p class="cs14438CD8"><span class="csBCF377F1">2018-07-29 08:58:37.408 Status: MySensors: Node: 0, Sketch Version: 1.0</span></p><p class="cs14438CD8"><span class="cs5FC355D3">Pasted from &lt;<a class="cs7B98B7A9" href="http://127.0.0.1:8080/#/Log"><span class="cs77704D4E">http://127.0.0.1:8080/#/Log</span></a></span><span class="cs5FC355D3">&gt; </span></p><p class="cs14438CD8"><span class="cs1B16EEB5">&nbsp;</span></p><p class="cs14438CD8"><span class="cs1B16EEB5">&nbsp;</span></p><p class="cs14438CD8"><span class="cs1B16EEB5">&nbsp;</span></p><p class="cs14438CD8"><span class="cs1B16EEB5">&nbsp;</span></p><p class="cs14438CD8"><span class="cs1B16EEB5">&nbsp;</span></p><p class="cs14438CD8"><span class="cs1B16EEB5">&nbsp;</span></p><p class="cs14438CD8"><span class="cs1B16EEB5">&nbsp;</span></p><p class="cs14438CD8"><span class="cs1B16EEB5">&nbsp;</span></p><p class="cs14438CD8"><span class="csD5D7D290"><img src="Domotics%20ESP8266-USB_files/image6.png" width="1209" height="247" alt="" style="border-width:0px;" /></span></p><p class="cs14438CD8"><span class="cs1B16EEB5">&nbsp;</span></p><p class="cs14438CD8"><span class="cs5FC355D3">Screen clipping taken: 29-Jul-18, 9:00</span></p><p class="cs14438CD8"><span class="cs1B16EEB5">&nbsp;</span></p><p class="cs14438CD8"><span class="cs1B16EEB5">&nbsp;</span></p><p class="cs14438CD8"><span class="cs1B16EEB5">&nbsp;</span></p><p class="cs14438CD8"><span class="cs1B16EEB5">&nbsp;</span></p><p class="cs14438CD8"><span class="cs1B16EEB5">&nbsp;</span></p><p class="cs14438CD8"><span class="csD5D7D290"><img src="Domotics%20ESP8266-USB_files/image7.png" width="944" height="249" alt="" style="border-width:0px;" /></span></p><p class="cs14438CD8"><span class="cs1B16EEB5">&nbsp;</span></p><p class="cs14438CD8"><span class="cs5FC355D3">Screen clipping taken: 29-Jul-18, 9:00</span></p><p class="cs14438CD8"><span class="cs1B16EEB5">&nbsp;</span></p><p class="cs14438CD8"><span class="cs1B16EEB5">&nbsp;</span></p><p class="cs14438CD8"><span class="cs1B16EEB5">&nbsp;</span></p><p class="cs14438CD8"><span class="csD5D7D290"><img src="Domotics%20ESP8266-USB_files/image8.png" width="972" height="633" alt="" style="border-width:0px;" /></span></p><p class="cs14438CD8"><span class="cs1B16EEB5">&nbsp;</span></p><p class="cs14438CD8"><span class="cs5FC355D3">Screen clipping taken: 29-Jul-18, 9:04</span></p><p class="cs14438CD8"><span class="cs1B16EEB5">&nbsp;</span></p><p class="cs14438CD8"><span class="cs1B16EEB5">&nbsp;</span></p><p class="cs14438CD8"><span class="cs1B16EEB5">&nbsp;</span></p><p class="cs95E872D0"><span class="csCF6BBF71">&nbsp;</span></p><p class="cs95E872D0"><span class="cs7FC7682D">Created with Microsoft Office OneNote 2007<br/>One place for all your notes and information</span></p></body>
</html>
